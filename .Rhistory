filter(Age_Group == input$age_group3, Purchase.Date >= input$date_range3[1] & Purchase.Date <= input$date_range3[2], Order.Status == input$order_status3)
if (input$relationship3 == "Product Type vs Add-On Purchase") {
ggplot(filtered_data3, aes(x = Product.Type, fill = Add_On)) +
geom_bar(position = "dodge") +
labs(title = paste("Add-On Purchases by Product Type for Age Group", input$age_group3, "and Order Status", input$order_status3), x = "Product Type", y = "Count") +
theme_minimal()
} else {
ggplot(filtered_data3, aes(x = Product.Type, fill = Shipping.Type)) +
geom_bar(position = "dodge") +
labs(title = paste("Shipping Type by Product Type for Age Group", input$age_group3, "and Order Status", input$order_status3), x = "Product Type", y = "Count") +
theme_minimal()
}
})
output$filtered_data <- renderTable({
req(input$visualization == "Customer Behavior Analysis")
cleaned_data %>%
filter(Age_Group == input$age_group3, Purchase.Date >= input$date_range3[1] & Purchase.Date <= input$date_range3[2], Order.Status == input$order_status3) %>%
select(Customer.ID, Age, Gender, Loyalty.Member, Product.Type, SKU, Order.Status, Total.Price, Add.on.Total)
})
# Graphical Query
reactiveData4 <- reactive({
cleaned_data %>%
filter(
Age_Group %in% input$age_group4,
Purchase.Date >= input$date_range4[1] & Purchase.Date <= input$date_range4[2],
Order.Status %in% input$order_status4,
Rating %in% as.integer(input$rating4)
)
})
output$graphical_query_plot <- renderPlot({
req(input$visualization == "Graphical Query")
data <- reactiveData4()
if (input$relationship4 == "Product Type vs Add-On Purchase") {
ggplot(data, aes(x = Product.Type, fill = Add_On)) +
geom_bar(position = "dodge") +
labs(title = paste("Add-On Purchases by Product Type for Selected Filters"), x = "Product Type", y = "Count") +
theme_minimal()
} else if (input$relationship4 == "Product Type vs Shipping Type") {
ggplot(data, aes(x = Product.Type, fill = Shipping.Type)) +
geom_bar(position = "dodge") +
labs(title = paste("Shipping Type by Product Type for Selected Filters"), x = "Product Type", y = "Count") +
theme_minimal()
} else if (input$relationship4 == "Total Price by SKU") {
data %>%
group_by(SKU, Gender) %>%
summarise(Total_Price = sum(Total.Price, na.rm = TRUE)) %>%
ggplot(aes(x = SKU, y = Total_Price, fill = Gender)) +
geom_col(position = position_dodge()) +
labs(title = "Total Price by SKU and Gender", x = "SKU", y = "Total Price") +
theme_minimal()
} else if (input$relationship4 == "Quantity by SKU") {
data %>%
group_by(SKU, Gender) %>%
summarise(Total_Quantity = sum(Quantity, na.rm = TRUE)) %>%
ggplot(aes(x = SKU, y = Total_Quantity, fill = Gender)) +
geom_col(position = position_dodge()) +
labs(title = "Quantity by SKU and Gender", x = "SKU", y = "Quantity") +
theme_minimal()
}
})
output$graphical_query_data <- renderTable({
req(input$visualization == "Graphical Query")
reactiveData4() %>%
select(Customer.ID, Age, Gender, Loyalty.Member, Product.Type, SKU, Order.Status, Total.Price, Add.on.Total)
})
}
# Run the application
shinyApp(ui = ui, server = server)
# Load necessary libraries
library(shiny)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyr)
# Define month levels for ordering
month_levels <- c("Sep", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug")
# Load and preprocess data
data <- read.csv("https://raw.githubusercontent.com/Aaron00Yu94/Milestone2/main/Electronic_sales_Sep2023-Sep2024.csv")
data$Purchase.Date <- as.Date(data$Purchase.Date, format = "%Y-%m-%d")
data$Month <- factor(format(data$Purchase.Date, "%b"), levels = month_levels)
# Preprocess other required columns and summaries
data <- data %>%
mutate(
Age_Group = cut(Age, breaks = seq(0, 100, by = 10),
labels = paste(seq(10, 100, by = 10) - 10, seq(10, 100, by = 10) - 1, sep = "-")),
Add_On_Purchase = ifelse(!is.na(Add.ons.Purchased) & Add.ons.Purchased != "", "Yes", "No")
)
cleaned_data <- data %>%
separate_rows(Add.ons.Purchased, sep = ",") %>%
mutate(Add_On = trimws(Add.ons.Purchased)) %>%
filter(!is.na(Add_On) & Add_On != "")
summary_data <- cleaned_data %>%
group_by(Month, Product.Type, Order.Status) %>%
summarise(Sales = n(), .groups = 'drop')
# UI definition
ui <- fluidPage(
titlePanel("Combined Sales Analysis Dashboard"),
sidebarLayout(
sidebarPanel(
# Dropdown to select visualization
selectInput("visualization", "Select Visualization:",
choices = c("Heatmap of Sales",
"Sales Analysis by Product Type",
"Customer Behavior Analysis",
"Graphical Query")),
# UI elements for each visualization
conditionalPanel(
condition = "input.visualization == 'Heatmap of Sales'",
dateRangeInput("dateRange1", "Select Date Range:", start = min(data$Purchase.Date), end = max(data$Purchase.Date)),
selectInput("productType1", "Select Product Type:", choices = c("All", unique(data$Product.Type)), selected = "All"),
selectInput("orderStatus1", "Select Order Status:", choices = c("All", unique(data$Order.Status)), selected = "All")
),
conditionalPanel(
condition = "input.visualization == 'Sales Analysis by Product Type'",
selectInput("product_type2", "Select Product Type:", choices = unique(data$Product.Type)),
textOutput("maxRevenueMonth")
),
conditionalPanel(
condition = "input.visualization == 'Customer Behavior Analysis'",
selectInput("age_group3", "Select Age Group:", choices = unique(data$Age_Group)),
dateRangeInput("date_range3", "Select Date Range:", start = min(data$Purchase.Date, na.rm = TRUE), end = max(data$Purchase.Date, na.rm = TRUE)),
selectInput("order_status3", "Select Order Status:", choices = c("Completed", "Cancelled"), selected = "Completed"),
selectInput("relationship3", "Select Relationship to View:", choices = c("Product Type vs Add-On Purchase", "Product Type vs Shipping Type", "Total Price by SKU", "Quantity by SKU"))
),
conditionalPanel(
condition = "input.visualization == 'Graphical Query'",
checkboxGroupInput("age_group4", "Select Age Group:", choices = unique(data$Age_Group), selected = unique(data$Age_Group)[1]),
dateRangeInput("date_range4", "Select Date Range:", start = min(data$Purchase.Date, na.rm = TRUE), end = max(data$Purchase.Date, na.rm = TRUE)),
checkboxGroupInput("order_status4", "Select Order Status:", choices = c("Completed", "Cancelled"), selected = "Completed"),
checkboxGroupInput("rating4", "Select Rating:", choices = unique(data$Rating), selected = unique(data$Rating)[1]),
selectInput("relationship4", "Select Relationship to View:", choices = c("Product Type vs Add-On Purchase", "Product Type vs Shipping Type", "Total Price by SKU", "Quantity by SKU"))
)
),
mainPanel(
# Output panels for each visualization
conditionalPanel(
condition = "input.visualization == 'Heatmap of Sales'",
plotOutput("heatmap")
),
conditionalPanel(
condition = "input.visualization == 'Sales Analysis by Product Type'",
tabsetPanel(
tabPanel("Sales Quantity", plotOutput("quantityPlot")),
tabPanel("Sales Revenue", plotOutput("revenuePlot"))
)
),
conditionalPanel(
condition = "input.visualization == 'Customer Behavior Analysis'",
plotOutput("relationship_plot"),
h4("Filtered Data"),
tableOutput("filtered_data")
),
conditionalPanel(
condition = "input.visualization == 'Graphical Query'",
plotOutput("graphical_query_plot"),
h4("Filtered Data"),
tableOutput("graphical_query_data")
)
)
)
)
# Server logic
server <- function(input, output) {
# Heatmap of Sales
output$heatmap <- renderPlot({
req(input$visualization == "Heatmap of Sales")
# Filter the data based on the selected date range and other filters
filtered_data <- summary_data %>%
filter(Month >= format(input$dateRange1[1], "%Y-%m") &
Month <= format(input$dateRange1[2], "%Y-%m"))
if (input$productType1 != "All") {
filtered_data <- filtered_data %>% filter(Product.Type == input$productType1)
}
if (input$orderStatus1 != "All") {
filtered_data <- filtered_data %>% filter(Order.Status == input$orderStatus1)
}
# Check if filtered_data is empty
if (nrow(filtered_data) == 0) {
return(NULL)
}
# Create the heatmap
ggplot(filtered_data, aes(x = Month, y = Product.Type, fill = Sales)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "blue", high = "red") +
labs(title = "Heatmap of Sales by Purchase Date, Product Type, and Order Status",
x = "Month", y = "Product Type", fill = "Sales Count") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
})
# Sales Analysis by Product Type
filtered_data2 <- reactive({
data %>%
filter(Product.Type == input$product_type2) %>%
group_by(Year = year(Purchase.Date), Month = factor(format(Purchase.Date, "%b"), levels = month_levels)) %>%
summarise(Total_Quantity = sum(Quantity, na.rm = TRUE), Total_Revenue = sum(Total.Price, na.rm = TRUE), .groups = "drop")
})
output$maxRevenueMonth <- renderText({
req(input$visualization == "Sales Analysis by Product Type")
data <- filtered_data2()
max_month <- data %>% filter(Total_Revenue == max(Total_Revenue, na.rm = TRUE)) %>% slice(1)
paste("The month with the highest revenue for", input$product_type2, "is", max_month$Month, max_month$Year, "with a total revenue of $", round(max_month$Total_Revenue, 2))
})
output$quantityPlot <- renderPlot({
req(input$visualization == "Sales Analysis by Product Type")
data <- filtered_data2()
ggplot(data, aes(x = Month, y = Total_Quantity, color = as.factor(Year), group = Year)) +
geom_line(size = 1) + geom_point(size = 2) +
labs(title = paste("Monthly Sales Quantity for", input$product_type2), x = "Month", y = "Total Quantity", color = "Year") +
theme_minimal() + scale_x_discrete(limits = month_levels, drop = FALSE)
})
output$revenuePlot <- renderPlot({
req(input$visualization == "Sales Analysis by Product Type")
data <- filtered_data2()
ggplot(data, aes(x = Month, y = Total_Revenue, color = as.factor(Year), group = Year)) +
geom_line(size = 1) + geom_point(size = 2) +
labs(title = paste("Monthly Sales Revenue for", input$product_type2), x = "Month", y = "Total Revenue", color = "Year") +
theme_minimal() + scale_x_discrete(limits = month_levels, drop = FALSE)
})
# Customer Behavior Analysis
output$relationship_plot <- renderPlot({
req(input$visualization == "Customer Behavior Analysis")
filtered_data3 <- cleaned_data %>%
filter(Age_Group == input$age_group3, Purchase.Date >= input$date_range3[1] & Purchase.Date <= input$date_range3[2], Order.Status == input$order_status3)
if (input$relationship3 == "Product Type vs Add-On Purchase") {
ggplot(filtered_data3, aes(x = Product.Type, fill = Add_On)) +
geom_bar(position = "dodge") +
labs(title = paste("Add-On Purchases by Product Type for Age Group", input$age_group3, "and Order Status", input$order_status3), x = "Product Type", y = "Count") +
theme_minimal()
} else {
ggplot(filtered_data3, aes(x = Product.Type, fill = Shipping.Type)) +
geom_bar(position = "dodge") +
labs(title = paste("Shipping Type by Product Type for Age Group", input$age_group3, "and Order Status", input$order_status3), x = "Product Type", y = "Count") +
theme_minimal()
}
})
output$filtered_data <- renderTable({
req(input$visualization == "Customer Behavior Analysis")
cleaned_data %>%
filter(Age_Group == input$age_group3, Purchase.Date >= input$date_range3[1] & Purchase.Date <= input$date_range3[2], Order.Status == input$order_status3) %>%
select(Customer.ID, Age, Gender, Loyalty.Member, Product.Type, SKU, Order.Status, Total.Price, Add.on.Total)
})
# Graphical Query
reactiveData4 <- reactive({
cleaned_data %>%
filter(
Age_Group %in% input$age_group4,
Purchase.Date >= input$date_range4[1] & Purchase.Date <= input$date_range4[2],
Order.Status %in% input$order_status4,
Rating %in% as.integer(input$rating4)
)
})
output$graphical_query_plot <- renderPlot({
req(input$visualization == "Graphical Query")
data <- reactiveData4()
if (input$relationship4 == "Product Type vs Add-On Purchase") {
ggplot(data, aes(x = Product.Type, fill = Add_On)) +
geom_bar(position = "dodge") +
labs(title = paste("Add-On Purchases by Product Type for Selected Filters"), x = "Product Type", y = "Count") +
theme_minimal()
} else if (input$relationship4 == "Product Type vs Shipping Type") {
ggplot(data, aes(x = Product.Type, fill = Shipping.Type)) +
geom_bar(position = "dodge") +
labs(title = paste("Shipping Type by Product Type for Selected Filters"), x = "Product Type", y = "Count") +
theme_minimal()
} else if (input$relationship4 == "Total Price by SKU") {
data %>%
group_by(SKU, Gender) %>%
summarise(Total_Price = sum(Total.Price, na.rm = TRUE)) %>%
ggplot(aes(x = SKU, y = Total_Price, fill = Gender)) +
geom_col(position = position_dodge()) +
labs(title = "Total Price by SKU and Gender", x = "SKU", y = "Total Price") +
theme_minimal()
} else if (input$relationship4 == "Quantity by SKU") {
data %>%
group_by(SKU, Gender) %>%
summarise(Total_Quantity = sum(Quantity, na.rm = TRUE)) %>%
ggplot(aes(x = SKU, y = Total_Quantity, fill = Gender)) +
geom_col(position = position_dodge()) +
labs(title = "Quantity by SKU and Gender", x = "SKU", y = "Quantity") +
theme_minimal()
}
})
output$graphical_query_data <- renderTable({
req(input$visualization == "Graphical Query")
reactiveData4() %>%
select(Customer.ID, Age, Gender, Loyalty.Member, Product.Type, SKU, Order.Status, Total.Price, Add.on.Total)
})
}
# Run the application
shinyApp(ui = ui, server = server)
# Load necessary libraries
library(shiny)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyr)
# Define month levels for ordering
month_levels <- c("Sep", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug")
# Load and preprocess data
data <- read.csv("https://raw.githubusercontent.com/Aaron00Yu94/Milestone2/main/Electronic_sales_Sep2023-Sep2024.csv")
data$Purchase.Date <- as.Date(data$Purchase.Date, format = "%Y-%m-%d")
data$Month <- factor(format(data$Purchase.Date, "%b"), levels = month_levels)
# Preprocess other required columns and summaries
data <- data %>%
mutate(
Age_Group = cut(Age, breaks = seq(0, 100, by = 10),
labels = paste(seq(10, 100, by = 10) - 10, seq(10, 100, by = 10) - 1, sep = "-")),
Add_On_Purchase = ifelse(!is.na(Add.ons.Purchased) & Add.ons.Purchased != "", "Yes", "No")
)
cleaned_data <- data %>%
separate_rows(Add.ons.Purchased, sep = ",") %>%
mutate(Add_On = trimws(Add.ons.Purchased)) %>%
filter(!is.na(Add_On) & Add_On != "")
summary_data <- cleaned_data %>%
group_by(Month, Product.Type, Order.Status) %>%
summarise(Sales = n(), .groups = 'drop')
# UI definition
ui <- fluidPage(
titlePanel("Combined Sales Analysis Dashboard"),
sidebarLayout(
sidebarPanel(
# Dropdown to select visualization
selectInput("visualization", "Select Visualization:",
choices = c("Heatmap of Sales",
"Sales Analysis by Product Type",
"Customer Behavior Analysis",
"Graphical Query")),
# UI elements for each visualization
conditionalPanel(
condition = "input.visualization == 'Heatmap of Sales'",
dateRangeInput("dateRange1", "Select Date Range:", start = min(data$Purchase.Date), end = max(data$Purchase.Date)),
selectInput("productType1", "Select Product Type:", choices = c("All", unique(data$Product.Type)), selected = "All"),
selectInput("orderStatus1", "Select Order Status:", choices = c("All", unique(data$Order.Status)), selected = "All")
),
conditionalPanel(
condition = "input.visualization == 'Sales Analysis by Product Type'",
selectInput("product_type2", "Select Product Type:", choices = unique(data$Product.Type)),
textOutput("maxRevenueMonth")
),
conditionalPanel(
condition = "input.visualization == 'Customer Behavior Analysis'",
selectInput("age_group3", "Select Age Group:", choices = unique(data$Age_Group)),
dateRangeInput("date_range3", "Select Date Range:", start = min(data$Purchase.Date, na.rm = TRUE), end = max(data$Purchase.Date, na.rm = TRUE)),
selectInput("order_status3", "Select Order Status:", choices = c("Completed", "Cancelled"), selected = "Completed"),
selectInput("relationship3", "Select Relationship to View:", choices = c("Product Type vs Add-On Purchase", "Product Type vs Shipping Type", "Total Price by SKU", "Quantity by SKU"))
),
conditionalPanel(
condition = "input.visualization == 'Graphical Query'",
checkboxGroupInput("age_group4", "Select Age Group:", choices = unique(data$Age_Group), selected = unique(data$Age_Group)[1]),
dateRangeInput("date_range4", "Select Date Range:", start = min(data$Purchase.Date, na.rm = TRUE), end = max(data$Purchase.Date, na.rm = TRUE)),
checkboxGroupInput("order_status4", "Select Order Status:", choices = c("Completed", "Cancelled"), selected = "Completed"),
checkboxGroupInput("rating4", "Select Rating:", choices = unique(data$Rating), selected = unique(data$Rating)[1]),
selectInput("relationship4", "Select Relationship to View:", choices = c("Product Type vs Add-On Purchase", "Product Type vs Shipping Type", "Total Price by SKU", "Quantity by SKU"))
)
),
mainPanel(
# Output panels for each visualization
conditionalPanel(
condition = "input.visualization == 'Heatmap of Sales'",
plotOutput("heatmap")
),
conditionalPanel(
condition = "input.visualization == 'Sales Analysis by Product Type'",
tabsetPanel(
tabPanel("Sales Quantity", plotOutput("quantityPlot")),
tabPanel("Sales Revenue", plotOutput("revenuePlot"))
)
),
conditionalPanel(
condition = "input.visualization == 'Customer Behavior Analysis'",
plotOutput("relationship_plot"),
h4("Filtered Data"),
tableOutput("filtered_data")
),
conditionalPanel(
condition = "input.visualization == 'Graphical Query'",
plotOutput("graphical_query_plot"),
h4("Filtered Data"),
tableOutput("graphical_query_data")
)
)
)
)
# Server logic
server <- function(input, output) {
# Heatmap of Sales
output$heatmap <- renderPlot({
req(input$visualization == "Heatmap of Sales")
# Filter the data based on the selected date range and other filters
filtered_data <- summary_data %>%
filter(Month >= format(input$dateRange1[1], "%Y-%m") &
Month <= format(input$dateRange1[2], "%Y-%m"))
if (input$productType1 != "All") {
filtered_data <- filtered_data %>% filter(Product.Type == input$productType1)
}
if (input$orderStatus1 != "All") {
filtered_data <- filtered_data %>% filter(Order.Status == input$orderStatus1)
}
# Check if filtered_data is empty
if (nrow(filtered_data) == 0) {
return(NULL)
}
# Create the heatmap
ggplot(filtered_data, aes(x = Month, y = Product.Type, fill = Sales)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "blue", high = "red") +
labs(title = "Heatmap of Sales by Purchase Date, Product Type, and Order Status",
x = "Month", y = "Product Type", fill = "Sales Count") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
})
# Sales Analysis by Product Type
filtered_data2 <- reactive({
data %>%
filter(Product.Type == input$product_type2) %>%
group_by(Year = year(Purchase.Date), Month = factor(format(Purchase.Date, "%b"), levels = month_levels)) %>%
summarise(Total_Quantity = sum(Quantity, na.rm = TRUE), Total_Revenue = sum(Total.Price, na.rm = TRUE), .groups = "drop")
})
output$maxRevenueMonth <- renderText({
req(input$visualization == "Sales Analysis by Product Type")
data <- filtered_data2()
max_month <- data %>% filter(Total_Revenue == max(Total_Revenue, na.rm = TRUE)) %>% slice(1)
paste("The month with the highest revenue for", input$product_type2, "is", max_month$Month, max_month$Year, "with a total revenue of $", round(max_month$Total_Revenue, 2))
})
output$quantityPlot <- renderPlot({
req(input$visualization == "Sales Analysis by Product Type")
data <- filtered_data2()
ggplot(data, aes(x = Month, y = Total_Quantity, color = as.factor(Year), group = Year)) +
geom_line(size = 1) + geom_point(size = 2) +
labs(title = paste("Monthly Sales Quantity for", input$product_type2), x = "Month", y = "Total Quantity", color = "Year") +
theme_minimal() + scale_x_discrete(limits = month_levels, drop = FALSE)
})
output$revenuePlot <- renderPlot({
req(input$visualization == "Sales Analysis by Product Type")
data <- filtered_data2()
ggplot(data, aes(x = Month, y = Total_Revenue, color = as.factor(Year), group = Year)) +
geom_line(size = 1) + geom_point(size = 2) +
labs(title = paste("Monthly Sales Revenue for", input$product_type2), x = "Month", y = "Total Revenue", color = "Year") +
theme_minimal() + scale_x_discrete(limits = month_levels, drop = FALSE)
})
# Customer Behavior Analysis
output$relationship_plot <- renderPlot({
req(input$visualization == "Customer Behavior Analysis")
filtered_data3 <- cleaned_data %>%
filter(Age_Group == input$age_group3, Purchase.Date >= input$date_range3[1] & Purchase.Date <= input$date_range3[2], Order.Status == input$order_status3)
if (input$relationship3 == "Product Type vs Add-On Purchase") {
ggplot(filtered_data3, aes(x = Product.Type, fill = Add_On)) +
geom_bar(position = "dodge") +
labs(title = paste("Add-On Purchases by Product Type for Age Group", input$age_group3, "and Order Status", input$order_status3), x = "Product Type", y = "Count") +
theme_minimal()
} else {
ggplot(filtered_data3, aes(x = Product.Type, fill = Shipping.Type)) +
geom_bar(position = "dodge") +
labs(title = paste("Shipping Type by Product Type for Age Group", input$age_group3, "and Order Status", input$order_status3), x = "Product Type", y = "Count") +
theme_minimal()
}
})
output$filtered_data <- renderTable({
req(input$visualization == "Customer Behavior Analysis")
cleaned_data %>%
filter(Age_Group == input$age_group3, Purchase.Date >= input$date_range3[1] & Purchase.Date <= input$date_range3[2], Order.Status == input$order_status3) %>%
select(Customer.ID, Age, Gender, Loyalty.Member, Product.Type, SKU, Order.Status, Total.Price, Add.on.Total)
})
# Graphical Query
reactiveData4 <- reactive({
cleaned_data %>%
filter(
Age_Group %in% input$age_group4,
Purchase.Date >= input$date_range4[1] & Purchase.Date <= input$date_range4[2],
Order.Status %in% input$order_status4,
Rating %in% as.integer(input$rating4)
)
})
output$graphical_query_plot <- renderPlot({
req(input$visualization == "Graphical Query")
data <- reactiveData4()
if (input$relationship4 == "Product Type vs Add-On Purchase") {
ggplot(data, aes(x = Product.Type, fill = Add_On)) +
geom_bar(position = "dodge") +
labs(title = paste("Add-On Purchases by Product Type for Selected Filters"), x = "Product Type", y = "Count") +
theme_minimal()
} else if (input$relationship4 == "Product Type vs Shipping Type") {
ggplot(data, aes(x = Product.Type, fill = Shipping.Type)) +
geom_bar(position = "dodge") +
labs(title = paste("Shipping Type by Product Type for Selected Filters"), x = "Product Type", y = "Count") +
theme_minimal()
} else if (input$relationship4 == "Total Price by SKU") {
data %>%
group_by(SKU, Gender) %>%
summarise(Total_Price = sum(Total.Price, na.rm = TRUE)) %>%
ggplot(aes(x = SKU, y = Total_Price, fill = Gender)) +
geom_col(position = position_dodge()) +
labs(title = "Total Price by SKU and Gender", x = "SKU", y = "Total Price") +
theme_minimal()
} else if (input$relationship4 == "Quantity by SKU") {
data %>%
group_by(SKU, Gender) %>%
summarise(Total_Quantity = sum(Quantity, na.rm = TRUE)) %>%
ggplot(aes(x = SKU, y = Total_Quantity, fill = Gender)) +
geom_col(position = position_dodge()) +
labs(title = "Quantity by SKU and Gender", x = "SKU", y = "Quantity") +
theme_minimal()
}
})
output$graphical_query_data <- renderTable({
req(input$visualization == "Graphical Query")
reactiveData4() %>%
select(Customer.ID, Age, Gender, Loyalty.Member, Product.Type, SKU, Order.Status, Total.Price, Add.on.Total)
})
}
# Run the application
shinyApp(ui = ui, server = server)
